{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/assessment%20for%20job/Todo%20Web%20Application/website/lib/apiHook.ts"],"sourcesContent":["import axios from \"axios\";\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE || \"https://todo-app.pioneeralpha.com\";\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n});\r\n\r\nexport const setAuthToken = (token?: string) => {\r\n  if (token) api.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\r\n  else delete api.defaults.headers.common[\"Authorization\"];\r\n};\r\n\r\n// Add request interceptor to ensure token is always included\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    // Try to get token from localStorage (check both possible keys)\r\n    if (typeof window !== \"undefined\") {\r\n      const token = localStorage.getItem(\"token\") || localStorage.getItem(\"todo_token\");\r\n      if (token && !config.headers[\"Authorization\"]) {\r\n        config.headers[\"Authorization\"] = `Bearer ${token}`;\r\n      }\r\n    }\r\n    \r\n    // If data is FormData, remove Content-Type header to let axios set it automatically with boundary\r\n    if (config.data instanceof FormData) {\r\n      delete config.headers[\"Content-Type\"];\r\n    }\r\n    \r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"names":[],"mappings":";;;;;;AACiB;AADjB;;AACA,MAAM,WAAW,2KAAO,CAAC,GAAG,CAAC,oBAAoB,IAAI;AAErD,MAAM,MAAM,mJAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,SAAS;QACP,gBAAgB;IAClB;AACF;AAEO,MAAM,eAAe,CAAC;IAC3B,IAAI,OAAO,IAAI,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;SACtE,OAAO,IAAI,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB;AAC1D;AAEA,6DAA6D;AAC7D,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,CAAC;IACC,gEAAgE;IAChE,wCAAmC;QACjC,MAAM,QAAQ,aAAa,OAAO,CAAC,YAAY,aAAa,OAAO,CAAC;QACpE,IAAI,SAAS,CAAC,OAAO,OAAO,CAAC,gBAAgB,EAAE;YAC7C,OAAO,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;QACrD;IACF;IAEA,kGAAkG;IAClG,IAAI,OAAO,IAAI,YAAY,UAAU;QACnC,OAAO,OAAO,OAAO,CAAC,eAAe;IACvC;IAEA,OAAO;AACT,GACA,CAAC;IACC,OAAO,QAAQ,MAAM,CAAC;AACxB;uCAGa"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///D:/assessment%20for%20job/Todo%20Web%20Application/website/lib/auth.ts"],"sourcesContent":["// lib/auth.ts\r\nimport api, { setAuthToken } from \"./apiHook\";\r\n\r\nconst TOKEN_KEY = \"todo_token\";\r\n\r\nexport const saveToken = (token: string) => {\r\n  localStorage.setItem(TOKEN_KEY, token);\r\n  setAuthToken(token);\r\n};\r\n\r\nexport const loadToken = () => {\r\n  const t = localStorage.getItem(TOKEN_KEY);\r\n  if (t) setAuthToken(t);\r\n  return t;\r\n};\r\n\r\nexport const clearToken = () => {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n  setAuthToken(undefined);\r\n};\r\n\r\n// API calls matching Django backend endpoints\r\nexport const signup = async (data: {\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n  password: string;\r\n}) => {\r\n  const res = await api.post(\"/api/users/signup/\", data);\r\n  return res.data;\r\n};\r\n\r\nexport const login = async (data: { email: string; password: string }) => {\r\n  // API uses email field for login\r\n  const res = await api.post(\"/api/auth/login/\", {\r\n    email: data.email,\r\n    password: data.password,\r\n  });\r\n  // Django JWT returns { access: \"...\", refresh: \"...\" }\r\n  return res.data;\r\n};\r\n\r\nexport const refreshToken = async (refresh: string) => {\r\n  const res = await api.post(\"/api/auth/refresh/\", { refresh });\r\n  return res.data;\r\n};\r\n\r\nexport const getProfile = async () => {\r\n  const res = await api.get(\"/api/users/me/\");\r\n  return res.data;\r\n};\r\n\r\nexport const changePassword = async (data: {\r\n  old_password: string;\r\n  new_password: string;\r\n}) => {\r\n  const res = await api.post(\"/api/users/change-password/\", data);\r\n  return res.data;\r\n};\r\n\r\nexport const updateProfile = async (data: {\r\n  first_name?: string;\r\n  last_name?: string;\r\n  email?: string;\r\n  address?: string;\r\n  contact_number?: string;\r\n  birthday?: string;\r\n  profile_image?: File;\r\n}) => {\r\n  // Ensure token is loaded before making request\r\n  const token = loadToken() || (typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null);\r\n  if (!token) {\r\n    throw new Error(\"No authentication token found\");\r\n  }\r\n\r\n  // Ensure token is set in axios instance\r\n  setAuthToken(token);\r\n\r\n  const formData = new FormData();\r\n  \r\n  // Append all fields, including empty strings to clear fields if needed\r\n  if (data.first_name !== undefined) formData.append(\"first_name\", data.first_name);\r\n  if (data.last_name !== undefined) formData.append(\"last_name\", data.last_name);\r\n  if (data.email !== undefined) formData.append(\"email\", data.email);\r\n  if (data.address !== undefined) formData.append(\"address\", data.address);\r\n  if (data.contact_number !== undefined) formData.append(\"contact_number\", data.contact_number);\r\n  if (data.birthday !== undefined) formData.append(\"birthday\", data.birthday);\r\n  \r\n  // Append file if it exists and is a File object\r\n  if (data.profile_image && data.profile_image instanceof File) {\r\n    formData.append(\"profile_image\", data.profile_image, data.profile_image.name);\r\n  }\r\n\r\n  // Send FormData - axios will automatically set Content-Type to multipart/form-data with boundary\r\n  // The interceptor will handle removing the default Content-Type header\r\n  const res = await api.patch(\"/api/users/me/\", formData);\r\n  return res.data;\r\n};\r\n\r\nexport const fetchTodos = async () => {\r\n  const res = await api.get(\"/api/todos/\");\r\n  // API returns paginated response with results array\r\n  return res.data.results || res.data;\r\n};\r\n\r\nexport const createTodo = async (payload: {\r\n  title: string;\r\n  description?: string;\r\n  priority?: \"extreme\" | \"moderate\" | \"low\";\r\n  todo_date?: string;\r\n}) => {\r\n  const res = await api.post(\"/api/todos/\", payload);\r\n  return res.data;\r\n};\r\n\r\nexport const updateTodo = async (id: string, payload: any) => {\r\n  const res = await api.patch(`/api/todos/${id}/`, payload);\r\n  return res.data;\r\n};\r\n\r\nexport const deleteTodo = async (id: string) => {\r\n  const res = await api.delete(`/api/todos/${id}/`);\r\n  return res.data;\r\n};\r\n\r\n// Reorder todos by updating position field\r\nexport const reorderTodos = async (todos: Array<{ id: string | number; position: number }>) => {\r\n  // Update each todo's position\r\n  const promises = todos.map((todo, index) =>\r\n    updateTodo(String(todo.id), { position: index + 1 })\r\n  );\r\n  await Promise.all(promises);\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 179, "column": 0}, "map": {"version":3,"sources":["file:///D:/assessment%20for%20job/Todo%20Web%20Application/website/app/%28auth%29/login/page.tsx"],"sourcesContent":["// app/(auth)/login/page.tsx\n\"use client\";\nimport React from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useAuth } from \"../../../components/AuthProvider\";\nimport { useRouter } from \"next/navigation\";\nimport { login as loginAPI, getProfile } from \"../../../lib/auth\";\nimport { setAuthToken } from \"../../../lib/apiHook\";\nimport Image from \"next/image\";\n\ntype FormData = { email: string; password: string };\n\nexport default function LoginPage() {\n  const { register, handleSubmit } = useForm<FormData>();\n  const auth = useAuth();\n  const router = useRouter();\n\n  const onSubmit = async (data: FormData) => {\n    try {\n      const response = await loginAPI({\n        email: data.email,\n        password: data.password,\n      });\n\n      if (auth && response.access) {\n        const token = response.access;\n        setAuthToken(token);\n\n        try {\n          const userData = await getProfile();\n          const user = {\n            id: userData.id || userData.pk || \"\",\n            name: userData.name || userData.username || data.email,\n            email: userData.email || data.email,\n          };\n\n          auth.login(user, token);\n          router.push(\"/todos\");\n        } catch {\n          const user = {\n            id: \"\",\n            name: data.email.split(\"@\")[0],\n            email: data.email,\n          };\n          auth.login(user, token);\n          router.push(\"/todos\");\n        }\n      } else {\n        alert(\"Invalid response from server\");\n      }\n    } catch (err: any) {\n      alert(err?.response?.data?.detail || err?.message || \"Login failed\");\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex bg-white\">\n      <div className=\"h-screen hidden md:flex w-1/2 secondary bg-secondary items-center justify-center\">\n        <Image\n          alt=\"Picture of the signupBanner\"\n          src=\"/images/login/loginBanner.png\"\n          height={344}\n          width={613}\n          loading=\"lazy\"\n          quality={100}\n        />\n      </div>\n\n      <div className=\"flex w-full md:w-1/2 items-center justify-center p-6 md:p-12\">\n        <form\n          onSubmit={handleSubmit(onSubmit)}\n          className=\"bg-white p-8 w-full max-w-md\"\n        >\n          <h2 className=\"text-[30px] font-bold font-inter mb-0 text-center\">\n            Create your account\n          </h2>\n\n          <p className=\"text-[16px] font-inter mb-6 text-center text-[#4B5563]\">\n            Start managing your tasks efficiently\n          </p>\n\n          {/* Email */}\n          <label className=\"block mb-2\">\n            <p className=\"font-medium text-[14px]\">Email</p>\n            <input\n              {...register(\"email\")}\n              type=\"email\"\n              required\n              placeholder=\"Enter your email\"\n              className=\"w-full mt-1 p-2 border rounded-md placeholder:text-[#8CA3CD]\"\n            />\n          </label>\n\n          {/* Password */}\n          <label className=\"block mb-2\">\n            <p className=\"font-medium text-[14px]\">Password</p>\n            <input\n              {...register(\"password\")}\n              type=\"password\"\n              required\n              placeholder=\"Enter your password \"\n              className=\"w-full mt-1 p-2 border rounded-md placeholder:text-[#8CA3CD]\"\n            />\n          </label>\n\n          <div className=\"flex items-center justify-between mb-4 mt-4\">\n            <label className=\"flex items-center gap-2 text-sm text-gray-700\">\n              <input type=\"checkbox\" className=\"h-4 w-4\" />\n              Remember me\n            </label>\n\n            <a href=\"#\" className=\"text-primary text-sm hover:underline\">\n              Forgot your password?\n            </a>\n          </div>\n\n          <button\n            type=\"submit\"\n            className=\"w-full py-2 rounded-md bg-[#5272FF] text-white mb-4\"\n          >\n            Log In\n          </button>\n\n          <p className=\"text-center text-sm text-gray-600\">\n            Don&apos;t have an account?{\" \"}\n            <a\n              href=\"/signup\"\n              className=\"text-primary hover:underline font-medium\"\n            >\n              Register now\n            </a>\n          </p>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;AAG5B;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AAWe,SAAS;;IACtB,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,GAAG,IAAA,4KAAO;IAC1C,MAAM,OAAO,IAAA,yIAAO;IACpB,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,WAAW,OAAO;QACtB,IAAI;YACF,MAAM,WAAW,MAAM,IAAA,uHAAQ,EAAC;gBAC9B,OAAO,KAAK,KAAK;gBACjB,UAAU,KAAK,QAAQ;YACzB;YAEA,IAAI,QAAQ,SAAS,MAAM,EAAE;gBAC3B,MAAM,QAAQ,SAAS,MAAM;gBAC7B,IAAA,iIAAY,EAAC;gBAEb,IAAI;oBACF,MAAM,WAAW,MAAM,IAAA,4HAAU;oBACjC,MAAM,OAAO;wBACX,IAAI,SAAS,EAAE,IAAI,SAAS,EAAE,IAAI;wBAClC,MAAM,SAAS,IAAI,IAAI,SAAS,QAAQ,IAAI,KAAK,KAAK;wBACtD,OAAO,SAAS,KAAK,IAAI,KAAK,KAAK;oBACrC;oBAEA,KAAK,KAAK,CAAC,MAAM;oBACjB,OAAO,IAAI,CAAC;gBACd,EAAE,OAAM;oBACN,MAAM,OAAO;wBACX,IAAI;wBACJ,MAAM,KAAK,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;wBAC9B,OAAO,KAAK,KAAK;oBACnB;oBACA,KAAK,KAAK,CAAC,MAAM;oBACjB,OAAO,IAAI,CAAC;gBACd;YACF,OAAO;gBACL,MAAM;YACR;QACF,EAAE,OAAO,KAAU;YACjB,MAAM,KAAK,UAAU,MAAM,UAAU,KAAK,WAAW;QACvD;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,2IAAK;oBACJ,KAAI;oBACJ,KAAI;oBACJ,QAAQ;oBACR,OAAO;oBACP,SAAQ;oBACR,SAAS;;;;;;;;;;;0BAIb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBACC,UAAU,aAAa;oBACvB,WAAU;;sCAEV,6LAAC;4BAAG,WAAU;sCAAoD;;;;;;sCAIlE,6LAAC;4BAAE,WAAU;sCAAyD;;;;;;sCAKtE,6LAAC;4BAAM,WAAU;;8CACf,6LAAC;oCAAE,WAAU;8CAA0B;;;;;;8CACvC,6LAAC;oCACE,GAAG,SAAS,QAAQ;oCACrB,MAAK;oCACL,QAAQ;oCACR,aAAY;oCACZ,WAAU;;;;;;;;;;;;sCAKd,6LAAC;4BAAM,WAAU;;8CACf,6LAAC;oCAAE,WAAU;8CAA0B;;;;;;8CACvC,6LAAC;oCACE,GAAG,SAAS,WAAW;oCACxB,MAAK;oCACL,QAAQ;oCACR,aAAY;oCACZ,WAAU;;;;;;;;;;;;sCAId,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAM,WAAU;;sDACf,6LAAC;4CAAM,MAAK;4CAAW,WAAU;;;;;;wCAAY;;;;;;;8CAI/C,6LAAC;oCAAE,MAAK;oCAAI,WAAU;8CAAuC;;;;;;;;;;;;sCAK/D,6LAAC;4BACC,MAAK;4BACL,WAAU;sCACX;;;;;;sCAID,6LAAC;4BAAE,WAAU;;gCAAoC;gCACnB;8CAC5B,6LAAC;oCACC,MAAK;oCACL,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb;GA5HwB;;QACa,4KAAO;QAC7B,yIAAO;QACL,kJAAS;;;KAHF"}}]
}